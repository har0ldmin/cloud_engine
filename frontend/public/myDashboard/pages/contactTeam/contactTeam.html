{% extends 'template/dashboard.html' %} {% block content %}


<style>
    /* Chat Now Button */
    :root {
        --custom-body-bg: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
        --custom-msger-bg: #fff;
        --custom-border: 2px solid #ddd;
        --custom-left-msg-bg: #ececec;
        --custom-right-msg-bg: #579ffb;
    }

    .chatNow {
        background-color: #F79901;
        border-color: #F79901;
        border-radius: 10px;
    }

    .chatNow:hover {
        background-color: #dd8800;
        border-color: #dd8800;
    }


    /* Chat Box */
    .custom-msger-header {
        display: flex;
        justify-content: space-between;
        padding: 10px;
        border-bottom: var(--custom-border);
        background: #eee;
        color: #666;
    }

    .custom-msger-chat {
        flex: 1;
        overflow-y: auto;
        padding: 10px;
    }

    .custom-msger-chat::-webkit-scrollbar {
        width: 6px;
    }

    .custom-msger-chat::-webkit-scrollbar-track {
        background: #ddd;
    }

    .custom-msger-chat::-webkit-scrollbar-thumb {
        background: #bdbdbd;
    }

    .custom-msg {
        display: flex;
        align-items: flex-end;
        margin-bottom: 10px;
    }

    .custom-msg:last-of-type {
        margin: 0;
    }

    .custom-msg-img {
        width: 50px;
        height: 50px;
        margin-right: 5px;
        background: #ddd;
        background-repeat: no-repeat;
        background-position: center;
        background-size: cover;
        border-radius: 50%;
    }

    .custom-msg-bubble {
        max-width: 450px;
        padding: 15px;
        border-radius: 15px;
        background: rgb(226, 226, 226);
    }

    .custom-msg-info {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 10px;
    }

    .custom-msg-info-name {
        margin-right: 5px;
        font-weight: bold;
    }

    .custom-msg-info-time {
        font-size: 0.75em;
    }

    .custom-left-msg .custom-msg-bubble {
        border-bottom-left-radius: 0;
    }

    .custom-right-msg {
        flex-direction: row-reverse;
    }

    .custom-right-msg .custom-msg-bubble {
        background: var(--custom-right-msg-bg);
        color: #fff;
        border-bottom-right-radius: 0;
    }

    .custom-right-msg .custom-msg-img {
        margin: 0 0 0 10px;
    }

    .custom-msger-inputarea {
        width: 100%;
        height: 20vh;
        z-index: 2;
        padding: 10px;
        border-top: var(--custom-border);
        background: #eee;
    }

    .custom-msger-inputarea * {
        padding: 10px;
        height: 15vh !important;
        border: none;
        border-radius: 3px;
        font-size: 1em;
    }

    .custom-input-icons i {
        position: absolute;
    }

    .custom-input-icons {
        width: 100%;
        margin-bottom: 10px;
    }

    .custom-icon {
        right: 3.5%;
        bottom: -12vh;
        transform: translateY(-50%);
        font-size: 1.2em;
        color: #888;
    }

    .custom-input-field {
        width: 100%;
        padding: 10px;
        text-align: center;
    }

    /* Message input */
    .custom-msger-input {
        flex: 1;
        background: #ddd;
        width: 100%;
        height: 8vh;
        resize: none;
        border-radius: 10px;
        font-size: 1em;
        resize: none;
        padding-right: 40px;
    }

    .custom-msger-send-btn {
        margin-left: 10px;
        background: #F79901;
        color: #fff;
        font-weight: bold;
        border-radius: 5px;
        cursor: pointer;
        transition: background 0.23s;
    }

    .custom-msger-send-btn:hover {
        background: #dd8800;
    }

    .custom-msger-chat {
        background-color: #fcfcfe;
        height: 40vh;
        overflow-y: auto;
    }


    /* go back icon */
    .goBackIcon {
        color: #e48d00;
    }

    .goBackIcon:hover {
        color: #e48d00cb;
    }

    /* Overlay helper */
    .overlay {
        position: absolute;
        height: 20%;
        width: 15%;
        background-color: rgba(225, 183, 114, 0.7);
        margin-top: 0.5%;
        border-radius: 10px;
        z-index: 1;
    }

    .nextBtn {
        position: absolute;
        bottom: 10;
        right: 15;
        border-radius: 5px;
    }

    .nextBtn:hover {
        background-color: rgb(78, 78, 78) !important;
        border-color: rgb(78, 78, 78) !important;
    }

    .skipBtn {
        position: absolute;
        bottom: 10;
        left: 15;
        border-radius: 5px;
        background-color: rgb(99, 99, 99);
        border-color: rgb(99, 99, 99);
        ;
    }

    .skipBtn:hover {
        background-color: rgb(78, 78, 78) !important;
        border-color: rgb(78, 78, 78) !important;
    }

    .description {
        position: absolute;
        left: 15;
        top: 10;
        color: white;
        font-size: 16px;
    }
</style>




<main class="content">

    <!-- This HTML code block displays a breadcrumb navigation bar and a heading for the "Contact Support Center" page. 
        It also includes a brief description of the page and a link to the support team. -->
    <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center py-4"
        style="margin-bottom: 2%;">
        <div class="d-block mb-4 mb-md-0">
            <nav aria-label="breadcrumb" class="d-none d-md-inline-block" style="padding-bottom: 10%;">
                <ol class="breadcrumb breadcrumb-dark breadcrumb-transparent">
                    <li class="breadcrumb-item">
                        <a href="/">
                            <svg class="icon icon-xxs" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                                xmlns="http://www.w3.org/2000/svg">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6">
                                </path>
                            </svg>
                        </a>
                    </li>
                    <li class="breadcrumb-item"><a href="#">My Dashboard</a></li>
                    <li class="breadcrumb-item active" aria-current="page"><a href="/contactTeam"
                            style="text-decoration: underline; color: #F79901;">Support Center</a></li>
                </ol>
            </nav>
            <div>
                <h2 class="h4">Contact Support Center</h2>
                <p class="mb-0">Get in touch with our support team at any time.</p>
            </div>
        </div>
    </div>


    <!-- Loading animation -->
    <div style="display: none;" id="loadingCircle">
        <div style="display: flex; justify-content: center; align-items: center; height: 40vh;">
            <a>
                <i class="fa fa-spinner fa-pulse fa-3x fa-fw" style="color: orange !important;"></i>
            </a>
        </div>
    </div>


    <!-- Assistants -->
    <div id="assistants" style="display: block;">

        <!-- Online Assistants -->
        <div class="row">
            <div class="col-12 col-xl-12">
                <div class="card card-body bg-white border-light shadow-sm mb-4">
                    <h2 class="h5 mb-4"><i class="fa fa-circle"
                            style="font-size: 18px; color: green; padding-left: 2%; padding-top: 1%; padding-bottom: 1%;"
                            aria-hidden="true"></i>&nbsp; Online</h2>
                    <div style="padding: 0px 25px;">
                        <form>
                            <div class="row">
                                <!-- Gerald -->
                                <div class="col-md-2 mb-3">
                                    <div>
                                        <!-- add photo -->
                                        <img src="../images/team/gerald.png" alt="..." class="rounded-circle mb-2"
                                            width="128" height="128" />
                                    </div>
                                    <a style="margin-left: 7%; font-weight: bolder;">Gerald Weber</a>
                                    <br>
                                    <br>
                                    <button class="btn btn-primary chatNow" style="margin-left: 7%;"
                                        onclick="talkToGerald()">Chat Now</button>
                                </div>

                                <!-- Asma -->
                                <div class="col-md-2 mb-2">
                                    <div>
                                        <!-- add photo -->
                                        <img src="../images/team/asma.png" alt="..." class="rounded-circle mb-2"
                                            width="128" height="128" />
                                    </div>
                                    <a style="margin-left: 10%; font-weight: bolder;">Asma Shakil</a>
                                    <br>
                                    <br>
                                    <button class="btn btn-primary chatNow" style="margin-left: 7%;"
                                        onclick="talkToAsma()">Chat Now</button>
                                </div>

                                <!-- Chat GPT -->
                                <div class="col-md-2 mb-2">
                                    <div>
                                        <!-- add photo -->
                                        <img src="../images/team/gpt.png" alt="..." class="rounded-circle mb-2"
                                            width="128" height="128" />
                                    </div>
                                    <a style="margin-left: 14%; font-weight: bolder;">GPT-3.5</a>
                                    <br>
                                    <br>
                                    <button class="btn btn-primary chatNow" style="margin-left: 7%;"
                                        onclick="talkToGpt()">Chat Now</button>
                                </div>

                                <!-- Helper modal -->
                                <div class="col-md-2 mb-2">
                                    <div class="overlay guideAvailableStaffs" style="display: none; height: 55%; width: 25%; background-color: rgba(225, 183, 114, 0.95);"><a
                                        class=" description">This section shows you the available staffs you can talk to. <br>You can simply click on "Chat Now" to start talking to them. </a>
                                      <br>
                                      <button class="btn btn-primary nextBtn" onclick="guideAvailableStaffsNext()">Next</button>
                                      <button class="btn btn-primary skipBtn" onclick="skipTutorial()">Skip</button>
                                    </div>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>

        <!-- Offline -->
        <div class="row">
            <div class="col-12 col-xl-12">
                <div class="card card-body bg-white border-light shadow-sm mb-4">
                    <h2 class="h5 mb-4"><i class="fa fa-circle"
                            style="font-size: 18px; color: red; padding-left: 2%; padding-top: 1%; padding-bottom: 1%;"
                            aria-hidden="true"></i>&nbsp; Offline</h2>
                    <div style="padding: 0px 25px;">
                        <form>
                            <div class="row">
                                <!-- Harold -->
                                <div class="col-md-2 mb-2">
                                    <div>
                                        <img src="../images/team/min.png" alt="..." class="rounded-circle mb-2"
                                            width="128" height="128" />
                                    </div>
                                    <a style="margin-left: 7%; font-weight: bolder;">Sangjun Min</a>
                                    <br>
                                    <br>
                                    <button class="btn btn-primary chatNow" style="margin-left: 7%;" disabled>Chat
                                        Now</button>
                                </div>

                                <!-- Han -->
                                <div class="col-md-2 mb-2">
                                    <div>
                                        <img src="../images/team/han.png" alt="..." class="rounded-circle mb-2"
                                            width="128" height="128" />
                                    </div>
                                    <a style="margin-left: 10%; font-weight: bolder;">Junhee Han</a>
                                    <br>
                                    <br>
                                    <button class="btn btn-primary chatNow" style="margin-left: 7%;" disabled>Chat
                                        Now</button>
                                </div>

                                <!-- Shinbeom -->
                                <div class="col-md-2 mb-2">
                                    <div>
                                        <img src="../images/team/shin.png" alt="..." class="rounded-circle mb-2"
                                            width="128" height="128" />
                                    </div>
                                    <a style="margin-left: 1%; font-weight: bolder;">Shinbeom Kwon</a>
                                    <br>
                                    <br>
                                    <button class="btn btn-primary chatNow" style="margin-left: 7%;" disabled>Chat
                                        Now</button>
                                </div>

                                <!-- Tanvi -->
                                <div class="col-md-2 mb-2">
                                    <div>
                                        <img src="../images/team/tanvi.png" alt="..." class="rounded-circle mb-2"
                                            width="128" height="128" />
                                    </div>
                                    <a style="margin-left: 11%; font-weight: bolder;">Tanvi Kher</a>
                                    <br>
                                    <br>
                                    <button class="btn btn-primary chatNow" style="margin-left: 7%;" disabled>Chat
                                        Now</button>
                                </div>

                                <!-- su -->
                                <div class="col-md-2 mb-2">
                                    <div>
                                        <img src="../images/team/kim.png" alt="..." class="rounded-circle mb-2"
                                            width="128" height="128" />
                                    </div>
                                    <a style="margin-left: 11%; font-weight: bolder;">Minsu Kim</a>
                                    <br>
                                    <br>
                                    <button class="btn btn-primary chatNow" style="margin-left: 7%;" disabled>Chat
                                        Now</button>
                                </div>

                                <!-- Helper modal -->
                                <div class="col-md-2 mb-2">
                                    <div class="overlay guideNotAvailableStaffs" style="display: none; height: 65%; width: 30%; margin-left: -20%; background-color: rgba(225, 183, 114);"><a
                                        class=" description">This section shows you the staffs who are currently unavailable.</a>
                                      <br>
                                      <button class="btn btn-primary nextBtn" onclick="guideNotAvailableStaffsNext()">Finish</button>
                                      <button class="btn btn-primary skipBtn" onclick="skipTutorial()">Skip</button>
                                    </div>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <!-- Open Chat Box-->
    <div id="chatBox" style="display: none;">
        <!-- Go back button on right of the screen -->
        <a href="/contactTeam" style="float: right; margin-top: -4%;">
            <i class="fa fa-chevron-circle-left goBackIcon" style="font-size:36px"></i>
        </a>

        <div class=" row">

            
            <!-- This code represents the header section of the contact team page. It includes a custom header with a title and a green circle icon. 
                The title is dynamically generated and will be filled in by JavaScript. -->
            <header class="custom-msger-header">
                <div class="custom-msger-header-title">
                    &nbsp; &nbsp; <i class="fa fa-circle" style="font-size: 10px; color: green;" aria-hidden="true"></i>
                    &nbsp;
                    <a id="assistantName"></a>
                </div>
            </header>

            <!-- 
            This HTML code block represents the chat interface for the user to contact the Cloud Engine assistant. 
            It contains a main element with a class of "custom-msger-chat" that holds the chat messages. The chat messages are represented by a div element with a class of "custom-msg". 
            The first message is a welcome message from the assistant with a profile photo container. The second message is the assistant's introduction with a name that is dynamically set using the "assistantName3" id. 
            The current time is displayed at the bottom right corner of the chat interface using the "custom-msg-info-time" class and "currentTime" id.
            -->
            <main class="custom-msger-chat">
                <div class="custom-msg custom-left-msg">
                    <div id="profilePhotoContainer">
                        <!-- Link goes in here -->
                    </div>

                    <div class="custom-msg-bubble">
                        <div class="custom-msg-info">
                            <div class="custom-msg-info-name"><a id="assistantName2"></a></div>
                        </div>

                        <div class="custom-msg-text">
                            Hi, thank you for using Cloud Engine. <br>My name is <a id="assistantName3"></a>, how
                            can I help
                            you today?
                        </div>
                    </div>
                </div>
                <div class="custom-msg-info-time" style="color: grey; margin-left: 4%;" id="currentTime"></div>
            </main>

            <!-- 
            This is a form for user input. It contains a textarea for the user to enter their message and two icons for submitting the message. 
            The first icon is for submitting the message using GPT and is initially hidden. The second icon is for submitting the message using the assistant and is initially displayed. 
            -->
            <form class="custom-msger-inputarea">
                <div class="custom-input-icons">
                    <i class="fa fa-paper-plane custom-icon" onclick="submitGPT()" id="gpt-submit"
                        style="display: none; color: #F79901;"></i>
                    <i class="fa fa-paper-plane custom-icon" onclick="submit()" id="assistant-submit"
                        style="display: block; color: #F79901;"></i>
                    <textarea type="text" class="custom-msger-input" placeholder="Enter your message..."></textarea>
                </div>
            </form>
        </div>
    </div>

</main>


<!-- ============================================================================================================== -->
<!-- ============================================================================================================== -->


<script>
    
    // <!-- 
    //     This function is used to initiate a chat with Gerald Weber.
    //     It shows a loading animation, hides the assistants, and sets a timer before showing the chat box.
    //     Once the timer is up, it hides the loading animation, shows the chat box, sets the assistant name to "Gerald Weber",
    //     sets the profile picture, and adds the current time automatically.
    // -->
    async function talkToGerald() {
        event.preventDefault();

        // show loading animation
        var loadingCircle = document.getElementById("loadingCircle");
        loadingCircle.style.display = "block";

        // hide assistants
        document.getElementById("assistants").style.display = "none";

        // set timer before showing the chat box
        await setTimeout(function () {
            loadingCircle.style.display = "none";
            document.getElementById("chatBox").style.display = "block";

            // set assistant name
            document.getElementById("assistantName").innerText = "Gerald Weber";
            document.getElementById("assistantName2").innerText = "Gerald Weber";
            document.getElementById("assistantName3").innerText = "Gerald Weber";

            // set profile picture
            let profileLink = '<div class="custom-msg-img" style="background-image: url(../images/gerald.png)"></div>';
            document.getElementById("profilePhotoContainer").innerHTML = profileLink;

            // add current time automatically
            let newTime = formatDate(new Date())
            document.getElementById("currentTime").innerText = newTime;
        }, 2000);
    }

    
    // <!-- 
    //     This function is used to initiate a chat with Asma Shakil.
    //     It shows a loading animation, hides the assistants, and sets a timer before showing the chat box.
    //     Once the timer is up, it hides the loading animation, shows the chat box, sets the assistant name to "Asma Shakil",
    //     sets the profile picture, and adds the current time automatically.
    // -->
    async function talkToAsma() {
        event.preventDefault();

        // show loading animation
        var loadingCircle = document.getElementById("loadingCircle");
        loadingCircle.style.display = "block";

        // hide assistants
        document.getElementById("assistants").style.display = "none";

        // set timer before showing the chat box
        await setTimeout(function () {
            loadingCircle.style.display = "none";
            document.getElementById("chatBox").style.display = "block";

            // set assistant name
            document.getElementById("assistantName").innerText = "Asma Shakil";
            document.getElementById("assistantName2").innerText = "Asma Shakil";
            document.getElementById("assistantName3").innerText = "Asma Shakil";

            // set profile picture
            let profileLink = '<div class="custom-msg-img" style="background-image: url(../images/team/asma.png)"></div>';
            document.getElementById("profilePhotoContainer").innerHTML = profileLink;

            // add current time automatically
            let newTime = formatDate(new Date())
            document.getElementById("currentTime").innerText = newTime;
        }, 2000);
    }

    
    // <!--
    //     This function is used to initiate a conversation with the GPT chatbot.
    //     It shows a loading animation, hides other assistants, and sets the chatbox to display after a set time.
    //     It also sets the assistant name, profile picture, and submit button to the GPT chatbot.
    //     Finally, it adds the current time to the chatbox.
    // -->
    async function talkToGpt() {
        event.preventDefault();

        // show loading animation
        var loadingCircle = document.getElementById("loadingCircle");
        loadingCircle.style.display = "block";

        // hide assistants
        document.getElementById("assistants").style.display = "none";

        // set timer before showing the chat box
        await setTimeout(function () {
            loadingCircle.style.display = "none";
            document.getElementById("chatBox").style.display = "block";

            // set assistant name
            document.getElementById("assistantName").innerText = "Chat GPT";
            document.getElementById("assistantName2").innerText = "Chat GPT";
            document.getElementById("assistantName3").innerText = "Chat GPT";

            // set profile picture
            let profileLink = '<div class="custom-msg-img" style="background-image: url(../images/team/gpt.png)"></div>';
            document.getElementById("profilePhotoContainer").innerHTML = profileLink;

            // replace to GPT-submit button
            document.getElementById("gpt-submit").style.display = "block";
            document.getElementById("assistant-submit").style.display = "none";

            // add current time automatically
            let newTime = formatDate(new Date())
            document.getElementById("currentTime").innerText = newTime;
        }, 2000);
    }
</script>




<!-- 
This script handles the chat functionality of the contact team page. It initializes the necessary elements and functions for the chat feature to work. 
It also contains the messages and images for the bot and the user. 

Functions:
- submit(): submits the user's message and triggers the bot's response
- appendMessage(name, img, side, text): appends a message to the chat window
- botResponse(): generates a random bot response and appends it to the chat window
- get(selector, root): returns the first element that matches the given selector
- formatDate(date): formats the given date to a string in the format "hh:mm"
- random(min, max): returns a random integer between min and max (inclusive)

Variables:
- msgerForm: the form element for submitting messages
- msgerInput: the input element for typing messages
- msgerChat: the chat window element
- BOT_MSGS: an array of messages for the bot to randomly select from
- BOT_IMG: the image for the bot
- PERSON_IMG: the image for the user
- BOT_NAME: the name of the bot
- PERSON_NAME: the name of the user
-->
<script>
    const msgerForm = get(".custom-msger-inputarea");
    const msgerInput = get(".custom-msger-input");
    const msgerChat = get(".custom-msger-chat");

    const BOT_MSGS = [
        "Hi, Harold :) Do you need any help?"];

    const BOT_IMG = "../images/gerald.png";
    const PERSON_IMG = "../images/min.png";
    const BOT_NAME = "Gerald Weber";
    const PERSON_NAME = "Harold Min";



    function submit() {
        const msgText = msgerInput.value;
        if (!msgText) return;

        appendMessage(PERSON_NAME, PERSON_IMG, "right", msgText);
        msgerInput.value = "";

        botResponse();

        msgerChat.scrollTop = msgerChat.scrollHeight;
    }


    msgerForm.addEventListener("submit", event => {
        event.preventDefault();
        submit();
    });


    function appendMessage(name, img, side, text) {
        let margin = '';
        if (side == "left") {
            margin = "margin-left: 4%;";
        }
        else {
            margin = "margin-left: 94%;";
        }

        const msgHTML = `
            <div class="custom-msg custom-${side}-msg">
                <div class="custom-msg-img" style="background-image: url(${img})"></div>

                <div class="custom-msg-bubble">
                <div class=custom-"msg-info">
                    <div class="custom-msg-info-name">${name}</div>
                </div>

                <div class="custom-msg-text">${text}</div>
                </div>
            </div>
            <div class="custom-msg-info-time" style="color:grey; ${margin}">${formatDate(new Date())}</div>
            `;

        msgerChat.insertAdjacentHTML("beforeend", msgHTML);
        msgerChat.scrollTop = msgerChat.scrollHeight;
    }

    function botResponse() {
        const r = random(0, BOT_MSGS.length - 1);
        const msgText = BOT_MSGS[r];
        const delay = msgText.split(" ").length * 300;

        setTimeout(() => {
            appendMessage(BOT_NAME, BOT_IMG, "left", msgText);

            msgerChat.scrollTop = msgerChat.scrollHeight;
        }, delay);
    }

    // Utils
    function get(selector, root = document) {
        return root.querySelector(selector);
    }

    function formatDate(date) {
        const h = "0" + date.getHours();
        const m = "0" + date.getMinutes();

        return `${h.slice(-2)}:${m.slice(-2)}`;
    }

    function random(min, max) {
        return Math.floor(Math.random() * (max - min) + min);
    }
</script>



<!-- 
This script defines a function called "submitGPT" that sends a user's message to the OpenAI GPT-3 API and appends the response to the chat window. It also defines a function called "showLoadingGPTDash" that displays a loading animation while waiting for the response from the API.

The script uses a constant API_KEY to store the API key for the OpenAI GPT-3 API. It also uses the following variables:
- msgerInput: the input field for the user's message
- msgerChat: the chat window
- msgText: the text of the user's message
- mytext: the trimmed text of the user's message, which is sent to the API
- responseFromGPT: the response from the API

The script sends a POST request to the OpenAI GPT-3 API with the user's message as the input. If the response is successful, it appends the response to the chat window. If the response is not successful, it appends an error message to the chat window.

The script also defines a function called "showLoadingGPTDash" that displays a loading animation while waiting for the response from the API.

-->
<script>
    const API_KEY = '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';

    async function submitGPT() {
        // Retrieve values from the form
        const msgerInput = get('.custom-msger-input');
        const msgerChat = get('.custom-msger-chat');

        // if msg is null
        const msgText = msgerInput.value;
        if (!msgText) return;

        // Append user's msg
        appendMessage(PERSON_NAME, PERSON_IMG, "right", msgText);
        msgerChat.scrollTop = msgerChat.scrollHeight;

        // trim input to send msg to gpt
        const mytext = msgerInput.value.trim();
        console.log(mytext);

        // clear input
        msgerInput.value = "";



        if (mytext) {
            try {
                showLoadingGPTDash();
                msgerChat.scrollTop = msgerChat.scrollHeight;

                const response = await fetch('https://api.openai.com/v1/chat/completions', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': 'Bearer ' + `${API_KEY}`,
                    },
                    body: JSON.stringify({
                        "model": 'gpt-3.5-turbo',
                        "messages":
                            [{
                                "role": 'user',
                                "content": mytext
                            }]
                    }),
                });
                if (response.ok) {
                    var loadingAnimation = document.getElementById("showLoadingGPT");
                    loadingAnimation.remove();

                    console.log("response ok received");
                    const data = await response.json();
                    // save response from gpt to variable
                    var responseFromGPT = data.choices[0].message.content;
                    // check response from gpt
                    console.log(responseFromGPT);

                    appendMessage("Chat GPT", "../images/team/gpt.png", "left", responseFromGPT);

                } else {
                    var loadingAnimation = document.getElementById("showLoadingGPT");
                    loadingAnimation.remove();

                    console.log(response);
                    var responseFromGPT = 'Error: Unable to process the request. Please try again.';
                    appendMessage("Chat GPT", "../images/team/gpt.png", "left", responseFromGPT);
                }
            } catch (error) {
                var loadingAnimation = document.getElementById("showLoadingGPT");
                loadingAnimation.remove();

                console.error(error);
                var responseFromGPT = 'Error Occured: Unable to process the request. Please try again.';
                appendMessage("Chat GPT", "../images/team/gpt.png", "left", responseFromGPT);
            }
        }
    }

    function showLoadingGPTDash() {
        const msgHTML = `
            <div class="custom-msg custom-left-msg" id="showLoadingGPT" style="display: block;">
                <div class="custom-msg-text"> <i class="fa fa-spinner fa-pulse fa-2x fa-fw" style="color:orange; margin-left: 3%"></i></div>
            </div>
            <div class="custom-msg-info-time" style="color:grey; margin-left: 4%;">${formatDate(new Date())}</div>
            `;

        msgerChat.insertAdjacentHTML("beforeend", msgHTML);
    }
</script>




<!-- 
This script defines functions that control the behavior of the guide overlay on the contact team page. 

Functions:
- guide(): opens the guide overlay and changes the color of the helper icon to orange.
- skipTutorial(): quits the tutorial instantly and hides all the helper overlays.
- guideAvailableStaffsNext(): hides the current helper overlay and shows the next one.
- guideNotAvailableStaffsNext(): hides the current helper overlay and quits the tutorial instantly.

Variables:
- guideStatus: a boolean variable that indicates whether the guide overlay is open or not.
-->
<script>
    // Default status
    guideStatus = false;

    // Opens the guide
    function guide() {
        if (guideStatus == false) {
            var helperIcon = document.querySelector(".fa-question-circle");
            helperIcon.style.color = "orange";
            guideStatus = true;

            let helper = document.querySelector(".guideAvailableStaffs");
            helper.style.display = "block";
        }
        else {
            skipTutorial();
            guideStatus = false;
        }
    }

    // Quit tutorial instantly
    function skipTutorial() {
        event.preventDefault();

        console.log("tutorial skipped");
        let helpers = document.querySelectorAll(".overlay");
        helpers.forEach(function (helper) {
            helper.style.display = "none";
        });

        var guideStatus = false;
        var helperIcon = document.querySelector(".fa-question-circle");
        helperIcon.style.color = "";
    }

    // ====================== //

    function guideAvailableStaffsNext() {
        event.preventDefault();

        let helper = document.querySelector(".guideAvailableStaffs");
        helper.style.display = "none";

        let helper2 = document.querySelector(".guideNotAvailableStaffs");
        helper2.style.display = "block";
    }

    function guideNotAvailableStaffsNext() {
        event.preventDefault();

        let helper = document.querySelector(".guideNotAvailableStaffs");
        helper.style.display = "none";

        skipTutorial();
    }
</script>



{% endblock %}